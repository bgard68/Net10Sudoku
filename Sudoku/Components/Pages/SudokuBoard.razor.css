.sudoku-root{display:flex;flex-direction:column;gap:12px;align-items:flex-start;padding:20px;position:relative}
.toolbar{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.toolbar .spacer{width:24px}
.btn{padding:8px 14px;border-radius:8px;border:none;cursor:pointer;font-weight:500;font-size:14px;transition:all .2s ease;box-shadow:0 2px 4px rgba(0,0,0,.1)}
.btn:hover{transform:translateY(-1px);box-shadow:0 4px 8px rgba(0,0,0,.15)}
.btn:active{transform:translateY(0);box-shadow:0 1px 2px rgba(0,0,0,.1)}
.btn.diff.easy{background:linear-gradient(135deg, #a8e6cf 0%, #7bc993 100%);color:#2d5f3f}
.btn.diff.med{background:linear-gradient(135deg, #ffd89b 0%, #ffb366 100%);color:#8b5a00}
.btn.diff.hard{background:linear-gradient(135deg, #ff9a9e 0%, #ff6b81 100%);color:#8b1a2b}
.btn.action{color:#fff;padding:8px 16px}
.btn.action.validate{background:linear-gradient(135deg, #667eea 0%, #764ba2 100%)}
.btn.action.validate:hover{background:linear-gradient(135deg, #5568d3 0%, #63408a 100%)}
.btn.action.hint{background:linear-gradient(135deg, #f093fb 0%, #f5576c 100%)}
.btn.action.hint:hover{background:linear-gradient(135deg, #de7ce8 0%, #dc4458 100%)}
.btn.action.solve{background:linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)}
.btn.action.solve:hover{background:linear-gradient(135deg, #3d92e5 0%, #00d9e5 100%)}
.btn.action.clear-all{background:linear-gradient(135deg, #fa709a 0%, #fee140 100%)}
.btn.action.clear-all:hover{background:linear-gradient(135deg, #e15e87 0%, #e5ca28 100%)}

.board-wrapper{position:relative;display:inline-block}
.board{display:inline-block;background:#fff;user-select:none;transition:all .3s ease}
.board.celebration{animation:board-flash 0.5s ease-in-out 3, board-rainbow 2s ease-in-out infinite 1.5s;box-shadow:0 0 30px rgba(255,215,0,.8),0 0 60px rgba(255,0,255,.6),0 0 90px rgba(0,255,255,.4)}

.srow{display:flex}
.cell{width:52px;height:52px;border:1px solid #d0d0d0;display:flex;align-items:center;justify-content:center;font-size:22px;outline:none;transition:box-shadow .2s ease, background .2s ease;cursor:pointer}
.cell.left3{border-left:4px solid #000}
.cell.top3{border-top:4px solid #000}
.cell.right3{border-right:4px solid #000}
.cell.bottom3{border-bottom:4px solid #000}
.cell.given{background:#fafafa;font-weight:bold}
.cell.selected{animation:selpulse 1.2s ease-in-out infinite;box-shadow:inset 0 0 0 2px #4b9cff}
.cell.rowhl:not(.selected):not(.conflict){background:linear-gradient(to right, rgba(75,156,255,.08), rgba(75,156,255,.02))}
.cell.colhl:not(.selected):not(.conflict){background:linear-gradient(to bottom, rgba(75,156,255,.08), rgba(75,156,255,.02))}
.cell.conflict{animation:conflictpulse 1.5s ease-in-out infinite;background:#ffe0e0;color:#c92a2a;font-weight:bold}
.celebration .cell{animation:cell-celebration 0.8s ease-in-out infinite}

.numpad{display:flex;gap:6px;flex-wrap:wrap;margin-top:8px}
.btn.num{width:40px;height:40px;padding:0;background:linear-gradient(135deg, #e0e7ff 0%, #cfd9fe 100%);color:#3730a3;font-weight:600;font-size:16px}
.btn.num:hover{background:linear-gradient(135deg, #c7d2fe 0%, #a5b4fc 100%)}
.btn.clear{background:linear-gradient(135deg, #fecaca 0%, #fca5a5 100%);color:#7f1d1d;font-weight:600}
.btn.clear:hover{background:linear-gradient(135deg, #fca5a5 0%, #f87171 100%)}
.message{min-height:1.2em;font-size:14px;color:#4b5563;font-weight:500}
.status{font-size:12px;color:#6b7280;font-style:italic}

/* Scrolling Congratulations Text */
.scrolling-text-container{
    position:absolute;
    top:-10px;
    left:-10px;
    right:-10px;
    bottom:-10px;
    pointer-events:none;
    overflow:hidden;
}

.scrolling-text{
    position:absolute;
    font-size:28px;
    font-weight:900;
    text-transform:uppercase;
    letter-spacing:4px;
    color:#39ff14;
    text-shadow:
        0 0 5px #39ff14,
        0 0 10px #39ff14,
        0 0 20px #39ff14,
        0 0 30px #39ff14,
        0 0 40px #00ff00,
        0 0 50px #00ff00,
        0 0 60px #00ff00,
        0 0 70px #00ff00,
        0 0 80px #00ff00;
    white-space:nowrap;
    animation:scroll-perimeter 18s linear infinite;
    filter:contrast(1.5) brightness(1.3);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
}

@keyframes scroll-perimeter{
    0%{top:-40px;left:0%;transform:translateX(0)}
    25%{top:0%;left:calc(100% + 20px);transform:translateX(0) rotate(90deg)}
    50%{top:calc(100% + 20px);left:100%;transform:translateX(-100%) rotate(180deg)}
    75%{top:100%;left:-40px;transform:translateX(0) rotate(270deg)}
    100%{top:-40px;left:0%;transform:translateX(0) rotate(360deg)}
}

/* Celebration Animations */
@keyframes board-flash{
    0%,100%{transform:scale(1);filter:brightness(1)}
    50%{transform:scale(1.02);filter:brightness(1.3) hue-rotate(0deg)}
}

@keyframes board-rainbow{
    0%{filter:hue-rotate(0deg) brightness(1.1)}
    25%{filter:hue-rotate(90deg) brightness(1.2)}
    50%{filter:hue-rotate(180deg) brightness(1.1)}
    75%{filter:hue-rotate(270deg) brightness(1.2)}
    100%{filter:hue-rotate(360deg) brightness(1.1)}
}

@keyframes cell-celebration{
    0%,100%{background:#fff;transform:scale(1)}
    25%{background:#ffe0ff;transform:scale(1.05)}
    50%{background:#e0ffff;transform:scale(1)}
    75%{background:#ffffe0;transform:scale(1.05)}
}

/* Professional Starbursts Container */
.starbursts-container{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:9999;overflow:hidden;perspective:1000px}

/* Individual Starburst */
.starburst{position:absolute;width:0;height:0;transform:translate(-50%,-50%);transform-style:preserve-3d}

/* Professional Particle with Realistic Physics */
.particle{
    position:absolute;
    width:4px;
    height:16px;
    top:0;
    left:0;
    background:linear-gradient(180deg, currentColor 0%, currentColor 60%, transparent 100%);
    border-radius:2px 2px 0 0;
    animation:particle-professional 2.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) infinite;
    filter:blur(0.3px);
    transform-origin:center bottom;
}

/* Realistic long trailing effect */
.particle::after{
    content:'';
    position:absolute;
    width:2px;
    height:200%;
    top:100%;
    left:50%;
    transform:translateX(-50%);
    background:linear-gradient(180deg, currentColor 0%, transparent 100%);
    opacity:0.4;
    filter:blur(0.8px);
}

@keyframes particle-professional{
    0%{
        transform:translate(0, 0) scale(1.5) rotateZ(0deg);
        opacity:0;
    }
    3%{
        opacity:1;
        transform:translate(0, 0) scale(1.5) rotateZ(0deg);
        box-shadow:
            0 0 15px currentColor,
            0 0 30px currentColor,
            0 0 45px rgba(255,255,255,0.8),
            0 0 60px currentColor;
    }
    15%{
        opacity:1;
        transform:translate(
            calc(cos(var(--angle)) * calc(var(--distance) * 0.3)),
            calc(sin(var(--angle)) * calc(var(--distance) * 0.3) - 5px)
        ) scale(1.3) rotateZ(calc(var(--angle) + 90deg));
        box-shadow:
            0 0 12px currentColor,
            0 0 25px currentColor,
            0 0 40px rgba(255,255,255,0.6);
    }
    40%{
        opacity:0.95;
        transform:translate(
            calc(cos(var(--angle)) * calc(var(--distance) * 0.7)),
            calc(sin(var(--angle)) * calc(var(--distance) * 0.7) + 15px)
        ) scale(1) rotateZ(calc(var(--angle) + 90deg));
    }
    70%{
        opacity:0.6;
        transform:translate(
            calc(cos(var(--angle)) * var(--distance)),
            calc(sin(var(--angle)) * var(--distance) + 40px)
        ) scale(0.7) rotateZ(calc(var(--angle) + 90deg));
        box-shadow:0 0 8px currentColor,0 0 16px currentColor;
    }
    100%{
        opacity:0;
        transform:translate(
            calc(cos(var(--angle)) * calc(var(--distance) * 1.1)),
            calc(sin(var(--angle)) * calc(var(--distance) * 1.1) + 60px)
        ) scale(0.3) rotateZ(calc(var(--angle) + 90deg));
        box-shadow:0 0 3px currentColor;
    }
}

/* Professional Shockwave Ring */
.starburst::before{
    content:'';
    position:absolute;
    top:50%;
    left:50%;
    width:70px;
    height:70px;
    border:5px solid rgba(255,255,255,0.95);
    border-radius:50%;
    transform:translate(-50%,-50%);
    animation:shockwave-professional 2.5s cubic-bezier(0.22, 1, 0.36, 1) infinite;
}

@keyframes shockwave-professional{
    0%{
        transform:translate(-50%,-50%) scale(0);
        opacity:0;
        border-width:6px;
        box-shadow:
            0 0 15px rgba(255,255,255,0.9),
            inset 0 0 15px rgba(255,255,255,0.6);
    }
    3%{
        opacity:1;
        border-width:5px;
    }
    15%{
        transform:translate(-50%,-50%) scale(2);
        opacity:0.95;
        border-width:4px;
    }
    40%{
        transform:translate(-50%,-50%) scale(5);
        opacity:0.6;
        border-width:2px;
    }
    100%{
        transform:translate(-50%,-50%) scale(8);
        opacity:0;
        border-width:0.5px;
        box-shadow:0 0 5px rgba(255,255,255,0.2);
    }
}

/* Secondary Atmospheric Glow */
.starburst::after{
    content:'';
    position:absolute;
    top:50%;
    left:50%;
    width:100px;
    height:100px;
    border-radius:50%;
    transform:translate(-50%,-50%);
    background:radial-gradient(circle, 
        rgba(255,255,255,0.9) 0%, 
        rgba(255,255,255,0.5) 20%,
        rgba(255,255,255,0.2) 40%,
        transparent 70%);
    animation:atmospheric-glow 2.5s ease-out infinite;
    mix-blend-mode:screen;
}

@keyframes atmospheric-glow{
    0%{
        transform:translate(-50%,-50%) scale(0);
        opacity:0;
    }
    5%{
        opacity:0.8;
    }
    20%{
        transform:translate(-50%,-50%) scale(3);
        opacity:0.6;
    }
    100%{
        transform:translate(-50%,-50%) scale(6);
        opacity:0;
    }
}

/* Glitter Sparkles with Natural Variation */
.particle::before{
    content:'';
    position:absolute;
    width:6px;
    height:6px;
    background:radial-gradient(circle, rgba(255,255,255,1) 0%, currentColor 40%, transparent 100%);
    border-radius:50%;
    top:-3px;
    left:50%;
    transform:translateX(-50%);
    animation:glitter-professional 1.8s ease-in-out infinite;
    box-shadow:
        0 0 8px rgba(255,255,255,0.9),
        0 0 16px currentColor;
}

@keyframes glitter-professional{
    0%,100%{
        transform:translateX(-50%) scale(0) rotate(0deg);
        opacity:0;
    }
    15%{
        transform:translateX(-50%) scale(1.8) rotate(180deg);
        opacity:1;
    }
    30%{
        transform:translateX(-50%) scale(1) rotate(360deg);
        opacity:0.7;
    }
    45%{
        transform:translateX(-50%) scale(1.5) rotate(540deg);
        opacity:1;
    }
    60%{
        transform:translateX(-50%) scale(0.8) rotate(720deg);
        opacity:0.6;
    }
    75%{
        transform:translateX(-50%) scale(1.2) rotate(900deg);
        opacity:0.4;
    }
}

@keyframes selpulse{0%{box-shadow:inset 0 0 0 0 #4b9cff}50%{box-shadow:inset 0 0 0 3px #4b9cff}100%{box-shadow:inset 0 0 0 0 #4b9cff}}
@keyframes conflictpulse{0%{background:#ffe0e0;box-shadow:inset 0 0 0 0 rgba(201,42,42,.3)}50%{background:#ffb3b3;box-shadow:inset 0 0 0 3px rgba(201,42,42,.5)}100%{background:#ffe0e0;box-shadow:inset 0 0 0 0 rgba(201,42,42,.3)}}

/* Dark Mode Styles */
.sudoku-root.dark-mode .board {
    background: #000000;
    border: 2px solid #ffffff;
}

.sudoku-root.dark-mode .cell {
    border: 1px solid #ffffff;
    background: #1a1a1a;
    color: #ffffff;
}

.sudoku-root.dark-mode .cell.left3 {
    border-left: 4px solid #ffffff;
}

.sudoku-root.dark-mode .cell.top3 {
    border-top: 4px solid #ffffff;
}

.sudoku-root.dark-mode .cell.right3 {
    border-right: 4px solid #ffffff;
}

.sudoku-root.dark-mode .cell.bottom3 {
    border-bottom: 4px solid #ffffff;
}

.sudoku-root.dark-mode .cell.given {
    background: #2a2a2a;
    color: #ffffff;
    font-weight: bold;
}

/* Ensure all numbers in dark mode are white */
.sudoku-root.dark-mode .cell span {
    color: #ffffff;
}

.sudoku-root.dark-mode .cell.selected {
    animation: selpulse-dark 1.2s ease-in-out infinite;
    background: #1a1a1a;
}

@keyframes selpulse-dark {
    0% { box-shadow: inset 0 0 0 0 #4b9cff; }
    50% { box-shadow: inset 0 0 0 3px #4b9cff; }
    100% { box-shadow: inset 0 0 0 0 #4b9cff; }
}

.sudoku-root.dark-mode .cell.rowhl:not(.selected):not(.conflict) {
    background: linear-gradient(to right, rgba(75, 156, 255, 0.15), rgba(75, 156, 255, 0.05));
    color: #ffffff;
}

.sudoku-root.dark-mode .cell.colhl:not(.selected):not(.conflict) {
    background: linear-gradient(to bottom, rgba(75, 156, 255, 0.15), rgba(75, 156, 255, 0.05));
    color: #ffffff;
}

.sudoku-root.dark-mode .cell.conflict {
    animation: conflictpulse-dark 1.5s ease-in-out infinite;
    background: #4a0000;
    color: #ff6b6b;
    font-weight: bold;
}

@keyframes conflictpulse-dark {
    0% { background: #4a0000; box-shadow: inset 0 0 0 0 rgba(255, 107, 107, 0.3); }
    50% { background: #660000; box-shadow: inset 0 0 0 3px rgba(255, 107, 107, 0.5); }
    100% { background: #4a0000; box-shadow: inset 0 0 0 0 rgba(255, 107, 107, 0.3); }
}

.sudoku-root.dark-mode .message {
    color: #d1d5db;
}

.sudoku-root.dark-mode .status {
    color: #9ca3af;
}

/* Dark mode celebration */
.sudoku-root.dark-mode .celebration .cell {
    animation: cell-celebration-dark 0.8s ease-in-out infinite;
}

@keyframes cell-celebration-dark {
    0%,100%{background:#000000;transform:scale(1)}
    25%{background:#1a001a;transform:scale(1.05)}
    50%{background:#001a1a;transform:scale(1)}
    75%{background:#1a1a00;transform:scale(1.05)}
}

.sudoku-root.dark-mode .board.celebration {
    animation: board-flash-dark 0.5s ease-in-out 3, board-rainbow 2s ease-in-out infinite 1.5s;
    box-shadow: 0 0 30px rgba(255, 215, 0, 0.8), 0 0 60px rgba(255, 0, 255, 0.6), 0 0 90px rgba(0, 255, 255, 0.4);
}

@keyframes board-flash-dark {
    0%, 100% { transform: scale(1); filter: brightness(1); }
    50% { transform: scale(1.02); filter: brightness(1.5) hue-rotate(0deg); }
}

.sudoku-root.dark-mode .scrolling-text {
    color: #39ff14;
    text-shadow:
        0 0 5px #39ff14,
        0 0 10px #39ff14,
        0 0 20px #39ff14,
        0 0 30px #39ff14,
        0 0 40px #00ff00,
        0 0 50px #00ff00,
        0 0 60px #00ff00,
        0 0 70px #00ff00,
        0 0 80px #00ff00;
    filter:contrast(1.5) brightness(1.3);
}
